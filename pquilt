#!/usr/bin/env python
# vim: fileencoding=utf-8 et sw=4 ts=4 tw=80:

# python-quilt - A Python implementation of the quilt patch system
#
# Copyright (C) 2012 - 2017 Bj√∂rn Ricks <bjoern.ricks@gmail.com>
#
# See LICENSE comming with the source of python-quilt for details.

import sys
import os.path

from quilt.cli import find_command, list_commands

from quilt.error import QuiltError

def usage():
    print("%s command [--help] ..." % os.path.basename(sys.argv[0]))
    print("Available commands:")
    for cmd in list_commands():
        print("\t" + cmd[0])

def main():
    if not len(sys.argv) > 1:
        usage()
        sys.exit(1)

    cmd = sys.argv[1]
    args = sys.argv[2:]

    try:
        cmd_cls = find_command(cmd)
        if not cmd_cls:
            print("command %s not known." % cmd)
            usage()
            sys.exit(2)
        cmd_cls().parse(args)
    except QuiltError as e:
        print(e)
        sys.exit(1)

if __name__ == "__main__":
        main()
